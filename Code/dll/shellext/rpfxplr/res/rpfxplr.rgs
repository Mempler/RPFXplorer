HKCR
{
	NoRemove CLSID
	{
		{AFE33D09-58FA-4B49-90AB-A9EF9E7A6C2E} = s 'RAGEArchive'
		{
			ProgID = s 'RAGEArchive'
			InprocServer32 = s '%MODULE%' { val ThreadingModel = s 'Apartment' }
			ShellFolder
			{
				val Attributes = d '4160749584'
				val UseDropHandler = s ''
			}

			'Implemented Categories' { '{00021490-0000-0000-C000-000000000046}' = s 'Browsable Shell Extension' { } }
		}

		'{08DC327C-3815-4DEE-9C84-AD5C80A45681}' = s 'RAGEArchive Folder Menu'
        {
            InprocServer32 = s '%MODULE%' { val ThreadingModel = s 'Apartment' }
        }
	}

	NoRemove Applications
	{
		'rpfxplr.dll' { val NoOpenWith = s '' }
	}

	NoRemove RAGEArchive
	{
		val FriendlyTypeName = s 'RAGE Archive Format'
		CLSID = s '{AFE33D09-58FA-4B49-90AB-A9EF9E7A6C2E}'
		DefaultIcon = s '%MODULE%'
		
		NoRemove Shell
		{
			NoRemove Open
			{
				val MultiSelectModel = s 'Document'

				Command = s 'rundll32.exe %MODULE%,ForwardToShell %%L'
			}
		}

		NoRemove ShellEx
		{
			NoRemove StorageHandler = s '{EBC8C101-27AE-48D8-BDB5-223451B4C2C2}'
		}
	}

	NoRemove .rpf = s 'RAGEArchive'
	{
		val 'Content Type' = s 'application/x-rage-archive'
		val PerceivedType  = s 'compressed'

		RAGEArchive
		{
			ForceRemove ShellNew
			{
				val ItemName = s 'RAGE Package'
				val Data = b '3746505201000000100000004F50454E0000000000FFFF7F0100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000'
			}
		}
	}
}
